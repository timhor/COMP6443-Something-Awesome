# Level 12

http://natas12.natas.labs.overthewire.org

![](assets/natas12.png)

At first glance, this level seems to lend itself to a file upload attack. Clicking on 'View sourcecode' brings us to the following code.

![](assets/natas12-solution-1.png)

The filename's `value` is generated by the `genRandomString` method with a `.jpg` extension subsequently appended to it. However, since this is client-side code, it can be directly changed using the browser's DevTools.

![](assets/natas12-solution-2.png)

Upload a file with the following contents and give it a `.php` extension.

```php
<?php
passthru('cat /etc/natas_webpass/natas13');
?>
```

After a successful upload, we can click on the link to cause the script to be executed by the server and show the password.

![](assets/natas12-solution-3.png)
